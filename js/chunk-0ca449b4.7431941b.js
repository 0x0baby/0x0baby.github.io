(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0ca449b4"],{"0d32":function(t,e,r){"use strict";r("bf0b")},"1e5f":function(t,e,r){},bf0b:function(t,e,r){},c72f:function(t,e,r){"use strict";r("1e5f")},ccb6:function(t,e,r){"use strict";r.r(e);var n=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("base-layout",[r("h2",{staticClass:"text-center my-30px"},[t._v(" 总收益: "),r("strong",[t._v(" "+t._s(t.formattedTotal)+" milk ")]),r("br")]),r("br"),r("a-row",{attrs:{gutter:[16,16]}},[r("a-col",{attrs:{md:12,sm:24}},[r("a-alert",{staticClass:"h-284px wallet-card",attrs:{type:"info",message:"钱包地址"},scopedSlots:t._u([{key:"description",fn:function(){return[t.account?[r("span",{staticStyle:{cursor:"pointer","margin-right":"5px"},attrs:{id:"account","data-clipboard-text":t.account}},[t._v(" "+t._s(t.account)+" ")]),t.copyStatus?r("span",{staticStyle:{color:"#19be6b"}},[r("a-icon",{attrs:{type:"check-circle"}}),t._v(" 复制成功 ")],1):r("a-tooltip",{attrs:{content:"点击复制",placement:"right"}},[r("a-icon",{staticStyle:{color:"#1890ff",cursor:"pointer"},attrs:{id:"copy-btn",type:"copy","data-clipboard-text":t.account,size:"20"}})],1)]:r("span",[t._v("暂无地址信息")]),r("div",{staticStyle:{"word-break":"break-all"}},[r("p",[t._v(" 卡片数量 "+t._s(t.cardsCount)+" 张")])])]},proxy:!0}])})],1),r("a-col",{attrs:{md:12,sm:24}},[r("a-alert",{attrs:{type:"warning",message:"使用说明"},scopedSlots:t._u([{key:"description",fn:function(){return[r("div",{staticStyle:{"word-break":"break-all"}},[r("p",[t._v(" 1. 本服务每十张卡需要支付 0.001 bnb (0.5u 左右)，不足十张按十张计算 ")])]),r("p",[t._v(" 2. 选中卡进行领取工资， "),r("strong",[t._v(" 收菜时会先向本服务转服务费，成功之后会批量弹出领取工资交易 ")])]),r("p",[t._v(" 3. 本工具完全开源，开源地址 "),r("strong",[r("a",{attrs:{href:"https://github.com/0x0baby/0x0baby.github.io",target:"_blank"}},[t._v("https://github.com/0x0baby/0x0baby.github.io ")])])])]},proxy:!0}])})],1)],1),r("br"),r("a-row",[r("a-col",[r("PropsTable",{attrs:{"data-source":t.propsDataSource,loading:t.loading},on:{fire:t.getAward,harvestAll:t.getAllAward,quitAll:t.quitAll,quitSelect:t.quitSelect},model:{value:t.selectedTokens,callback:function(e){t.selectedTokens=e},expression:"selectedTokens"}})],1)],1)],1)},a=[],o=r("b85c"),s=r("1da1"),c=(r("96cf"),r("b680"),r("d3b7"),r("25f0"),r("9c9e")),i=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("p",{staticClass:"text-center m-0"},[r("a-space",{staticClass:"flex-wrap"},[r("a-button",{staticClass:"mb-16px",attrs:{type:"primary"},on:{click:function(e){return t.$emit("fire")}}},[t._v(" 选中领取工资 ")]),r("a-button",{staticClass:"mb-16px",attrs:{disabled:!t.groupRecords.gt2kRecords.length,type:"primary"},on:{click:t.exec2k}},[t._v(" 收2000 ")]),r("a-button",{staticClass:"mb-16px",attrs:{type:"primary"},on:{click:t.execAll}},[t._v(" 全部领取工资 ")]),r("a-button",{staticClass:"mb-16px",attrs:{type:"primary"},on:{click:t.quitSelect}},[t._v(" 选中退出工作 ")]),r("a-button",{staticClass:"mb-16px",attrs:{type:"primary"},on:{click:t.quitAll}},[t._v(" 全部退出工作 ")])],1)],1),r("a-table",{attrs:{bordered:"",loading:t.loading,columns:t.tableColumns,"data-source":t.dataSourceWithKey,scroll:{x:!0},pagination:!1,"row-selection":{selectedRowKeys:t.selectedRowKeys,onChange:t.onSelectChange}},scopedSlots:t._u([{key:"tokenId",fn:function(e,n){return[r("div",{staticClass:"flex-center"},[r("span",{attrs:{title:n.tokenId}},[t._v(t._s(t.displayOptimize(n.tokenId)))]),r("a-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"primary",size:"small",id:"btn-"+n.key,"data-clipboard-text":n.tokenId},on:{click:function(e){return t.copyAddr(n.key)}}},[t._v(" 复制 ")])],1)]}},{key:"workType",fn:function(e,n){return[1===n.workType?r("a-tag",{attrs:{color:"#1890ff"}},[t._v("全职")]):2===n.workType?r("a-tag",{attrs:{color:"#faad14"}},[t._v("兼职")]):t._e()]}}])})],1)},u=[],l=r("5530"),d=(r("d81d"),r("ac1f"),r("b311")),p=r.n(d),f=r("ed08"),h={props:{dataSource:{type:Array,required:!0},loading:{type:Boolean,default:!0},value:{type:Array,required:!0}},data:function(){return{selectedRowKeys:[]}},computed:{tableColumns:function(){return[{title:"token id",width:120,scopedSlots:{customRender:"tokenId"}},{title:"工作",dataIndex:"work",width:90},{title:"等级",dataIndex:"level",width:90,sorter:function(t,e){return t.level-e.level},sortDirections:["ascend","descend"]},{title:"力量",width:90,dataIndex:"strength",sorter:function(t,e){return t.strength-e.strength},sortDirections:["ascend","descend"]},{title:"敏捷",width:90,dataIndex:"agility",sorter:function(t,e){return t.agility-e.agility},sortDirections:["ascend","descend"]},{title:"体质",width:90,dataIndex:"physique",sorter:function(t,e){return t.physique-e.physique},sortDirections:["ascend","descend"]},{title:"意志",width:90,dataIndex:"volition",sorter:function(t,e){return t.volition-e.volition},sortDirections:["ascend","descend"]},{title:"智力",width:90,dataIndex:"brains",sorter:function(t,e){return t.brains-e.brains},sortDirections:["ascend","descend"]},{title:"精神",width:90,dataIndex:"charm",sorter:function(t,e){return t.charm-e.charm},sortDirections:["ascend","descend"]},{title:"收益",width:100,dataIndex:"gold",sorter:function(t,e){return t.gold-e.gold},sortDirections:["ascend","descend"]}]},dataSourceWithKey:function(){return this.dataSource.map((function(t){return Object(l["a"])(Object(l["a"])({},t),{},{key:Object(f["a"])(),gold:t.gold})}))},groupRecords:function(){var t,e=[],r=[],n=[],a=Object(o["a"])(this.dataSourceWithKey);try{for(a.s();!(t=a.n()).done;){var s=t.value;1===s.workType?e.push(s):r.push(s),s.gold>=2e3&&n.push(s)}}catch(c){a.e(c)}finally{a.f()}return{fullTimeRecords:e,partTimeRecords:r,gt2kRecords:n}}},methods:{onSelectChange:function(t,e){this.selectedRowKeys=t,this.selectedRows=e,this.$emit("input",e)},displayOptimize:function(t){var e=/(\w{2}).+(\w{2})/.exec(t);return"".concat(e[1],"....")},copyAddr:function(t){var e=this,r=new p.a("#btn-".concat(t));r.on("success",(function(){e.$message.success("复制成功"),r.destroy()}))},exec2k:function(){this.selectedRowKeys=this.groupRecords.gt2kRecords.map((function(t){return t.key})),this.fireWithRecords(this.groupRecords.gt2kRecords)},execAll:function(){this.selectedRowKeys=this.dataSourceWithKey.map((function(t){return t.key})),this.$emit("input",this.dataSourceWithKey),this.$emit("harvestAll")},quitSelect:function(){console.log("quit select: ",this.selectedRows),this.$emit("input",this.selectedRows),this.$emit("quitSelect")},quitAll:function(){this.selectedRowKeys=this.dataSourceWithKey.map((function(t){return t.key})),this.$emit("input",this.dataSourceWithKey),this.$emit("quitAll")},fireWithRecords:function(t){console.log("records:",t),this.$emit("input",t),this.$emit("fire")}}},b=h,m=(r("c72f"),r("2877")),g=Object(m["a"])(b,i,u,!1,null,"0f44696b",null),y=g.exports,w={name:"Harvest",mixins:[c["a"]],components:{PropsTable:y},data:function(){return{rate:0,total:0,tokens:[],selectedTokens:[],loading:!0,feeRate:10,baseFee:.001,propsDataSource:[],copyStatus:0,goldPrice:0,work:null,partTimeWork:null,playContract:null,feeContract:null,cardsCount:0}},computed:{formattedTotal:function(){var t=+this.total;return t?t.toFixed(2):t},totalUsd:function(){var t=+this.total;return t?(t*this.goldPrice).toFixed(2):0}},created:function(){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.initWeb3Account();case 2:if(t.account){e.next=4;break}return e.abrupt("return");case 4:return t.initContract(),e.next=7,t.getGoldInfo();case 7:case"end":return e.stop()}}),e)})))()},mounted:function(){var t=this;window.getProperty=this.getProperty;var e=new p.a("#account"),r=new p.a("#copy-btn"),n=function(){t.copyStatus=!0,setTimeout((function(){t.copyStatus=!1}),3e3)};r.on("success",n),e.on("success",n)},methods:{getGoldInfo:function(){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function e(){var r,n,a,s,c,i,u,l;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r=t.web3.utils.toBN(0),n=[],e.next=4,t.getWorkingTokenIds(t.account);case 4:a=e.sent,s=Object(o["a"])(a),e.prev=6,s.s();case 8:if((c=s.n()).done){e.next=25;break}return i=c.value,e.next=12,t.getProperty(i);case 12:return u=e.sent,e.next=15,t.getNftAward(i);case 15:l=e.sent,l=t.web3.utils.toBN(l),t.tokens.push({token_id:i,gold:t.web3.utils.fromWei(l)}),u.gold=t.web3.utils.fromWei(l),u.work="奶牛站",n.push(u),r.iadd(l),t.cardsCount+=1;case 23:e.next=8;break;case 25:e.next=30;break;case 27:e.prev=27,e.t0=e["catch"](6),s.e(e.t0);case 30:return e.prev=30,s.f(),e.finish(30);case 33:t.propsDataSource=n,t.loading=!1,t.total=t.web3.utils.fromWei(r.toString(),"ether");case 36:case"end":return e.stop()}}),e,null,[[6,27,30,33]])})))()},calculateFee:function(t){return"".concat(Math.ceil(t.length/this.feeRate)*this.baseFee)},quitSelect:function(){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function e(){var r,n,a,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(r=t.selectedTokens,console.log("select tokens: ",r),r.length){e.next=5;break}return t.$message.error("至少选择一项后操作"),e.abrupt("return");case 5:n=Object(o["a"])(r);try{for(n.s();!(a=n.n()).done;)s=a.value,t.milkStationContract.methods.withdraw(s.tokenId).send({from:t.account})}catch(c){n.e(c)}finally{n.f()}case 7:case"end":return e.stop()}}),e)})))()},quitAll:function(){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:console.log("quitall"),t.milkStationContract.methods.withdrawAll().send({from:t.account});case 2:case"end":return e.stop()}}),e)})))()},getAllAward:function(){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function e(){var r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:r=t.selectedTokens,t.payFee(r,(function(e){void 0==e?t.harvestAll():console.log("error: ",e)})).catch((function(){t.$message.error("支付失败")}));case 2:case"end":return e.stop()}}),e)})))()},getAward:function(){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function e(){var r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(r=t.selectedTokens,console.log("select tokens: ",r),r.length){e.next=5;break}return t.$message.error("至少选择一项后操作"),e.abrupt("return");case 5:t.payFee(r,(function(e){if(void 0==e){var n,a=Object(o["a"])(r);try{for(a.s();!(n=a.n()).done;){var s=n.value;t.harvest(s.tokenId)}}catch(c){a.e(c)}finally{a.f()}}else console.log("error: ",e)})).catch((function(){t.$message.error("支付失败")}));case 6:case"end":return e.stop()}}),e)})))()},payFee:function(t,e){var r=this.calculateFee(t);return this.web3.eth.sendTransaction({from:this.account,to:"0x4d09c2578690c7D4285D616f3eB1F53128148738",value:this.web3.utils.toWei(r)},e)}}},k=w,v=(r("0d32"),Object(m["a"])(k,n,a,!1,null,"68fb3b2b",null));e["default"]=v.exports}}]);
//# sourceMappingURL=chunk-0ca449b4.7431941b.js.map