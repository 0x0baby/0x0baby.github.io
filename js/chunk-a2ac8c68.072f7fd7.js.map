{"version":3,"sources":["webpack:///./src/views/Card.vue?43d7","webpack:///src/views/Card.vue","webpack:///./src/views/Card.vue?2cce","webpack:///./src/views/Card.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","_v","_s","bnx","attrs","on","getCard","batchGetCard","staticRenderFns","name","mixins","data","bnxContract","playContract","mageContract","warriorContract","rangerContract","robberContract","katrinaContract","pancakeContract","methods","initContract","web3","eth","Contract","component"],"mappings":"yHAAA,IAAIA,EAAS,WAAa,IAAIC,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,cAAc,CAACA,EAAG,KAAK,CAACE,YAAY,uBAAuB,CAACN,EAAIO,GAAG,QAAQH,EAAG,KAAK,CAACE,YAAY,eAAe,CAACN,EAAIO,GAAG,eAAeH,EAAG,IAAI,CAACJ,EAAIO,GAAGP,EAAIQ,GAAGR,EAAIS,KAAK,aAAaL,EAAG,MAAMA,EAAG,SAAS,CAACE,YAAY,eAAe,CAACF,EAAG,UAAU,CAACA,EAAG,WAAW,CAACM,MAAM,CAAC,KAAO,WAAWC,GAAG,CAAC,MAAQX,EAAIY,UAAU,CAACZ,EAAIO,GAAG,QAAQH,EAAG,WAAW,CAACM,MAAM,CAAC,KAAO,WAAWC,GAAG,CAAC,MAAQX,EAAIa,eAAe,CAACb,EAAIO,GAAG,UAAU,IAAI,IAAI,IACpgBO,EAAkB,G,wGCyBtB,GACEC,KAAM,OACNC,OAAQ,CAACA,EAAX,MACEC,KAHF,WAII,MAAO,CACLR,IAAK,EACLS,YAAa,KACbC,aAAc,KACdC,aAAc,KACdC,gBAAiB,KACjBC,eAAgB,KAChBC,eAAgB,KAChBC,gBAAiB,KACjBC,gBAAiB,OAGrB,QAhBF,WAgBA,wKACA,oBADA,UAEA,UAFA,wDAMA,iBANA,SAOA,cAPA,uBAQA,mBARA,8CAUEC,QAAS,CACPC,aADJ,WAEM1B,KAAKiB,YAAc,IAAIjB,KAAK2B,KAAKC,IAAIC,SAC3C,EACA,qBAEM7B,KAAKkB,aAAe,IAAIlB,KAAK2B,KAAKC,IAAIC,SAC5C,EACA,sBAEM7B,KAAKmB,aAAe,IAAInB,KAAK2B,KAAKC,IAAIC,SAC5C,EACA,sBAEM7B,KAAKoB,gBAAkB,IAAIpB,KAAK2B,KAAKC,IAAIC,SAC/C,EACA,yBAEM7B,KAAKqB,eAAiB,IAAIrB,KAAK2B,KAAKC,IAAIC,SAC9C,EACA,wBAEM7B,KAAKsB,eAAiB,IAAItB,KAAK2B,KAAKC,IAAIC,SAC9C,EACA,wBAEM7B,KAAKuB,gBAAkB,IAAIvB,KAAK2B,KAAKC,IAAIC,SAC/C,EACA,yBAEM7B,KAAKwB,gBAAkB,IAAIxB,KAAK2B,KAAKC,IAAIC,SAC/C,EACA,0BAII,UApCJ,WAoCA,8KACA,kDADA,OACA,EADA,OAEA,qBACA,WACA,iDAJA,8CAOI,QA3CJ,WA2CA,4LACA,cADA,uBAEA,yCAFA,cAEA,EAFA,gBAGA,4CAHA,cAGA,EAHA,iBAIA,yCAJA,WAIA,EAJA,OAKA,yBACA,iCAEA,QARA,wBAUA,6BAVA,kCAaA,qCAEA,uBACA,iBACA,eAjBA,UAmBA,uBACA,sBACA,aACA,eACA,UAvBA,QAmBA,EAnBA,OAyBA,sBAEA,uBACA,sBACA,MACA,eACA,QACA,YAhCA,+CAmCI,aA9EJ,WA8EA,8JACA,IADA,YACA,KADA,gCAEA,YAFA,OACA,IADA,6DAKI,eAnFJ,WAmFA,wLACA,uBACA,qBACA,OAHA,cACA,EADA,gBAIA,0BACA,qBACA,OANA,cAIA,EAJA,gBAOA,yBACA,qBACA,OATA,cAOA,EAPA,iBAUA,yBACA,qBACA,OAZA,eAUA,EAVA,iBAaA,0BACA,qBACA,OAfA,QAwBA,IAXA,EAbA,OAgBA,YACA,EACA,EACA,EACA,EACA,GAGA,aAxBA,iDCvI+d,I,YCO3dC,EAAY,eACd,EACAhC,EACAe,GACA,EACA,KACA,KACA,MAIa,aAAAiB,E","file":"js/chunk-a2ac8c68.072f7fd7.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('base-layout',[_c('h2',{staticClass:\"text-center my-30px\"},[_vm._v(\"抽卡\")]),_c('h3',{staticClass:\"text-center\"},[_vm._v(\" 当前bnx 数量： \"),_c('b',[_vm._v(_vm._s(_vm.bnx)+\" bnx \")])]),_c('br'),_c('a-card',{staticClass:\"text-center\"},[_c('a-space',[_c('a-button',{attrs:{\"type\":\"primary\"},on:{\"click\":_vm.getCard}},[_vm._v(\"单抽\")]),_c('a-button',{attrs:{\"type\":\"primary\"},on:{\"click\":_vm.batchGetCard}},[_vm._v(\"五连抽\")])],1)],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <base-layout>\n    <h2 class=\"text-center my-30px\">抽卡</h2>\n    <h3 class=\"text-center\">\n      当前bnx 数量：\n      <b>{{ bnx }} bnx </b>\n    </h3>\n    <br />\n\n    <a-card class=\"text-center\">\n      <a-space>\n        <a-button type=\"primary\" @click=\"getCard\">单抽</a-button>\n        <a-button type=\"primary\" @click=\"batchGetCard\">五连抽</a-button>\n      </a-space>\n    </a-card>\n  </base-layout>\n</template>\n\n<script>\nimport mixins from \"@/mixins\";\nimport bnxAbi from \"@/abi/bnx.json\";\nimport playAbi from \"@/abi/play.json\";\nimport erc721Abi from \"@/abi/erc721.json\";\nimport pancakeAbi from \"@/abi/erc721.json\";\nimport config from \"@/config\";\n\nexport default {\n  name: \"Home\",\n  mixins: [mixins],\n  data() {\n    return {\n      bnx: 0,\n      bnxContract: null,\n      playContract: null,\n      mageContract: null,\n      warriorContract: null,\n      rangerContract: null,\n      robberContract: null,\n      katrinaContract: null,\n      pancakeContract: null,\n    };\n  },\n  async created() {\n    await this.initWeb3Account();\n    if (!this.account) {\n      return;\n    }\n\n    this.initContract();\n    await this.updateBnx();\n    await this.getCurrentCard();\n  },\n  methods: {\n    initContract() {\n      this.bnxContract = new this.web3.eth.Contract(\n        bnxAbi,\n        config.bnxContrAddr\n      );\n      this.playContract = new this.web3.eth.Contract(\n        playAbi,\n        config.playContrAddr\n      );\n      this.mageContract = new this.web3.eth.Contract(\n        erc721Abi,\n        config.mageContrAddr\n      );\n      this.warriorContract = new this.web3.eth.Contract(\n        erc721Abi,\n        config.warriorContrAddr\n      );\n      this.rangerContract = new this.web3.eth.Contract(\n        erc721Abi,\n        config.rangerContrAddr\n      );\n      this.robberContract = new this.web3.eth.Contract(\n        erc721Abi,\n        config.robberContrAddr\n      );\n      this.katrinaContract = new this.web3.eth.Contract(\n        erc721Abi,\n        config.katrinaContrAddr\n      );\n      this.pancakeContract = new this.web3.eth.Contract(\n        pancakeAbi,\n        config.pancakeContrAddr\n      );\n    },\n    // 获取当前钱包的 bnx 数量\n    async updateBnx() {\n      const bnx = await this.bnxContract.methods.balanceOf(this.account).call();\n      console.log(\"bnx\", bnx);\n      this.rawBnx = bnx;\n      this.bnx = this.web3.utils.fromWei(bnx.toString(), \"ether\");\n    },\n    // 单次抽卡\n    async getCard() {\n      await this.updateBnx();\n      const goldPay = await this.playContract.methods.payValue().call();\n      const bnxPay = await this.playContract.methods.payBnxValue().call();\n      const bnbPay = await this.playContract.methods.bnbValue().call();\n      const needBnx = new this.web3.utils.BN(bnxPay);\n      const currentBnx = new this.web3.utils.BN(this.rawBnx);\n\n      if (needBnx.gt(currentBnx)) {\n        // bnx 数量不足\n        this.$message.error(\"bnx 数量不足\");\n        return;\n      }\n      console.log(\"newPlayerTrade:\", goldPay, bnxPay, entropyString);\n\n      const t = new Date().getTime();\n      const entropyString = this.account + t + \"\";\n      console.log(t);\n\n      const gas = await this.playContract.methods\n        .newPlayerTrade(goldPay, bnxPay, entropyString)\n        .estimateGas({\n          from: this.account,\n          value: bnbPay,\n        });\n      console.log(\"gas:\", gas);\n\n      this.playContract.methods\n        .newPlayerTrade(goldPay, bnxPay, entropyString)\n        .send({\n          from: this.account,\n          value: bnbPay,\n          gas: gas + 1e5,\n        });\n    },\n    async batchGetCard() {\n      for (let i = 0; i < 5; i++) {\n        await this.getCard();\n      }\n    },\n    async getCurrentCard() {\n      const mageCount = await this.mageContract.methods\n        .balanceOf(this.account)\n        .call();\n      const warriorCount = await this.warriorContract.methods\n        .balanceOf(this.account)\n        .call();\n      const rangerCount = await this.rangerContract.methods\n        .balanceOf(this.account)\n        .call();\n      const robberCount = await this.robberContract.methods\n        .balanceOf(this.account)\n        .call();\n      const katrinaCount = await this.katrinaContract.methods\n        .balanceOf(this.account)\n        .call();\n      console.log(\n        mageCount,\n        rangerCount,\n        robberCount,\n        warriorCount,\n        katrinaCount\n      );\n      // const tokenIds = []\n      for (let i = 0; i < mageCount; i++) {\n        // const tokenId = this.mageContract.methods\n      }\n    },\n  },\n};\n</script>\n","import mod from \"-!../../node_modules/windicss-webpack-plugin/dist/loaders/pitcher.js!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../node_modules/windicss-webpack-plugin/dist/loaders/transform-template.js!./Card.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/windicss-webpack-plugin/dist/loaders/pitcher.js!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../node_modules/windicss-webpack-plugin/dist/loaders/transform-template.js!./Card.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Card.vue?vue&type=template&id=f6c70008&\"\nimport script from \"./Card.vue?vue&type=script&lang=js&\"\nexport * from \"./Card.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}